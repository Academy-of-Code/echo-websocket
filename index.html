<html>
  <head>
    <script>
      let HOST = 'wss://echo-websocket-ms.herokuapp.com/'
      let ws = new WebSocket(HOST);
      let el;
      
      function heartbeat(){
        clearTimeout(this.pingTimeout);
        
        this.pingTimeout = setTimeout(() => {
          this.terminate();
        }, 30000 + 1000);
      }

      ws.on('open', heartbeat);
      ws.on('ping', heartbeat);
      ws.on('close', function clear() {
        clearTimeout(this.pingTimeout);
      });
      ws.on('message', function incoming(data) {
        el = document.getElementById('server-time');
        el.innerHTML = event.data;
      });
    </script>
  </head>
  <body>
    <p id="server-time"></p>
    <textarea id="msgInput"></textarea>
    <button id='sendMsg' onclick='if(document.getElementById("msgInput").value !== ""){ws.send(document.getElementById("msgInput").value)}'>Send message</button>
  </body>
</html>
